var app=angular.module("casting",["ngRoute","firebase","appCtrls","dcbImgFallback"]),appCtrls=angular.module("appCtrls",["firebase"]);app.config(["$routeProvider",function(e){e.when("/agenda",{templateUrl:"views/agenda.html",controller:"AgendaCtrl"}).when("/projects/:projectID/chat",{templateUrl:"views/chat.html",controller:"ChatCtrl"}).when("/home",{templateUrl:"views/projects.html",controller:"ProjectsCtrl"}).when("/apply",{templateUrl:"views/apply.html",controller:"ApplyCtrl"}).when("/applicant/:applicantID",{templateUrl:"views/details.html",controller:"ApplicantCtrl"}).when("/projects/:projectID",{templateUrl:"views/project.html",controller:"ProjectCtrl"}).when("/users/:userID",{templateUrl:"views/projects.html",controller:"MyProjectsCtrl"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterCtrl"}).when("/login",{templateUrl:"views/login.html",controller:"RegisterCtrl"}).when("/select",{templateUrl:"views/select.html",controller:"SelectCtrl"}).when("/thanks",{templateUrl:"views/thanks.html"}).when("/",{templateUrl:"views/login.html"}).otherwise({redirectTo:"/"})}]),app.controller("RegisterCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope",function(e,t,r,s,o){var a=new Firebase("https://casting.firebaseio.com/users");e.authObj=s(a),e.sync=r(a),e.newUser=e.sync.$asObject(),e.register=function(){e.authObj.$createUser({email:e.user.email,password:e.user.password}).then(function(){return e.authObj.$authWithPassword({email:e.user.email,password:e.user.password})}).then(function(r){o.authData=r,console.log("data",r),e.sync.$set(r.uid,e.user),o.director=r,t.path("/home")}).catch(function(r){console.log(r),e.authError=r.message,t.path("/register")})},e.login=function(){e.authObj.$authWithPassword({email:e.user.email,password:e.user.password}).then(function(e){o.director=e,t.path("/home")}).catch(function(r){console.log(r),e.authError=r.message,t.path("/login")})}}]),app.controller("AgendaCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope",function(e,t,r,s){var o=new Firebase("https://casting.firebaseio.com/");r(o);var a=new Firebase("https://casting.firebaseio.com/");e.authObj=s(a),e.authObj.$onAuth(function(s){if(s){var o=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(o),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t})}else t.path("/login")})}]),app.controller("ApplyCtrl",["$scope","$firebase","$location",function(e,t,r){var s=new Firebase("https://casting.firebaseio.com/applications"),o=t(s);e.applications=o.$asArray(),e.apply=function(){e.applications.$add(e.application).then(function(){e.application={},e.applicationForm.$setUntouched(),r.path("/thanks")})}}]),app.controller("ApplicantCtrl",["$scope","$firebase","$routeParams",function(e,t,r){var s=new Firebase("https://casting.firebaseio.com/applications/"+r.applicantID);e.sync=t(s),e.currentApplicant=e.sync.$asObject(),console.log("Current Applicant",e.currentApplicant),console.log("Current project in applicant",e.currentProject)}]),app.controller("StatusCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope",function(e,t,r,s,o){o.$on("$firebaseAuth:login",function(t,r){console.log("email: ",r),e.userEmail=r.email});var a=new Firebase("https://casting.firebaseio.com/home");e.authObj=s(a),e.authObj.$onAuth(function(t){if(t){var s=new Firebase("https://casting.firebaseio.com/users/"+t.uid);e.user=r(s),e.currentuser=e.user.$asObject()}else console.log("Logged out")})}]),app.controller("NotesCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope","$routeParams",function(e,t,r,s,o,a){var n=new Firebase("https://casting.firebaseio.com/applications/"+a.applicantID+"/notes"),c=r(n),i=new Firebase("https://casting.firebaseio.com/applications/"+a.applicantID+"/notes");e.authObj=s(i),e.authObj.$onAuth(function(s){if(s){var o=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(o),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t})}else t.path("/login")}),e.notes=c.$asArray(),console.log("notes ",e.notes),e.addMessage=function(t){e.fullName=e.currentuser.fname+" "+e.currentuser.lname,13==t.keyCode&&e.notes.$add({from:e.fullName,text:e.newMessage,id:e.currentuser.$id}).then(function(){e.newMessage=""})}}]),app.controller("ChatCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope","$routeParams",function(e,t,r,s,o,a){var n=new Firebase("https://casting.firebaseio.com/projects/"+a.projectID+"/chat"),c=r(n),i=new Firebase("https://casting.firebaseio.com/projects/"+a.projectID+"/chat");e.authObj=s(i),e.authObj.$onAuth(function(s){if(s){var o=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(o),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t})}else t.path("/login")}),e.messages=c.$asArray(),e.addMessage=function(t){e.fullName=e.currentuser.fname+" "+e.currentuser.lname,13==t.keyCode&&e.messages.$add({from:e.fullName,text:e.newMessage,id:e.currentuser.$id}).then(function(){e.newMessage=""})}}]),app.controller("ProjectsCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope",function(e,t,r,s){var o=new Firebase("https://casting.firebaseio.com/projects"),a=r(o),n=new Firebase("https://casting.firebaseio.com/projects");e.authObj=s(n),e.authObj.$onAuth(function(s){if(s){var o=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(o),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t})}else t.path("/login")}),e.projects=a.$asArray(),e.addProject=function(){e.project.user_id=e.currentuser.$id,e.projects.$add(e.project).then(function(){e.project={}})}}]),app.controller("ProjectCtrl",["$scope","$firebase","$routeParams",function(e,t,r){var s=new Firebase("https://casting.firebaseio.com/projects/"+r.projectID);e.sync=t(s),e.currentProject=e.sync.$asObject()}]),app.controller("SelectCtrl",["$scope","$firebase","$routeParams",function(e,t){var r=new Firebase("https://casting.firebaseio.com/projects/");e.sync=t(r),e.projects=e.sync.$asArray()}]),app.controller("CategoryCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope","$routeParams",function(e,t,r,s,o,a){var n=new Firebase("https://casting.firebaseio.com/applications/"+a.applicantID+"/category"),c=r(n),i=new Firebase("https://casting.firebaseio.com/applications/"+a.applicantID+"/category");e.authObj=s(i),e.authObj.$onAuth(function(s){if(s){var o=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(o),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t})}else t.path("/login")}),e.category=c.$asArray(),e.categorize=function(){e.category.$save({category:e.category}).then(function(){console.log("category: ",e.category)})}}]),app.controller("MyProjectsCtrl",["$scope","$location","$firebase","$firebaseAuth","$rootScope","$routeParams",function(e,t,r,s,o,a){var n=new Firebase("https://casting.firebaseio.com/users/"+a.userID+"/myprojects");e.authObj=s(n),e.authObj.$onAuth(function(s){if(s){var a=new Firebase("https://casting.firebaseio.com/users/"+s.uid);e.user=r(a),e.currentuser=e.user.$asObject(),e.currentuser.$loaded().then(function(t){e.currentuser=t,console.log("user",e.currentuser);var s=new Firebase("https://casting.firebaseio.com/users/"+e.currentuser.$id+"/myprojects"),a=r(s);o.myprojects=a.$asArray()})}else t.path("/login")}),e.addMyProject=function(){e.myprojects.$add({id:e.projectsKey}).then(function(){e.projectsKey=""})}}]),app.filter("projectfilter",function(){return function(){var e=[];return console.log("myprojects",$rootScope.myprojects),angular.forEach($rootScope.myprojects,function(e){this.push(e),console.log("value",e)},e),e}});